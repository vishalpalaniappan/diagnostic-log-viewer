# Diagnostic Log Viewer

The Diagnostic Log Viewer (DLV) is a tool which can be used to view and interact with Compressed Diagnostic Log (CDL) files. See background for more information on CDL files. The DLV can be used to step through the execution sequence of a program using the debug toolkit while investigating the call stack, variables and exceptions. It can also be used to set breakpoints and investigate specific parts of the program.

# Demo 

A demo of the current basic version of Semantic Execution Graph (SEG) based navigation is available [here][demo-seg-url].
* This demo was generated by injecting logs into the [Library Manager][library-manager-sample] sample program in the [ADLI][adli-url] tool.
* The sample program contains instrumented abstractions and a Semantic Design Graph (SDG) which is included in the header of the trace file generated by the execution.
* This trace viewer uses the SDG to create a SEG through the execution and allows the user to navigate the trace using this graph. 
* This basic implementation preserves stack based navigation and introduces the SEG. This is an intermediate step before switchin entirely to SEG based navigation.

A demo of the viewer for a multi threaded program is available [here][demo-url-multi-thread]. 
* The demo CDL file was generated by injecting diagnostic logs into this [program][threaded] and running it.
* In Thread3.py, this program also has async functions which can be used to inspect async call stack extraction.

A demo of the viewer for a single threaded program is available [here][demo-url].
* The demo CDL file was generated by injecting diagnostic logs into the [ADLI][adli-url] tool and then the log injected ADLI program was used to inject logs into [adli_system.py][adli-system] from the ADLI repo.
* A bug was intentionally introduced and the program was executed, generating the CDL file used in the demo.
  
# How does it work? 

The DLV spawns a worker to do the following: 

* Parses the header of the CDL file to extract the logtype map, variable map and the source code for each file in the program. 
* Traverses the body of the CDL file and extracts the execution sequence as well as the corresponding variables and exceptions.
* Collapses the file by extracting the stack trace for each position.
* Provides the variables, stack trace and exceptions given a position in the program. 
* Provides commands to step through the program.
* Provides the ability to set breakpoints.
* Provides the ability to enable/disable breakpoints.
* Provides the ability to play a program back from a given position (forward or backward) and to replay the program from the start.

The React application contains a CDL Provider which exposes all relevant data through contexts that can be consumed by child components. The major components in the react application are the file viewer, call stack container, variable container, breakpoint container and the debug tool kit.

#Background

> [!NOTE]  
> A more detailed introduction to diagnostic logging and the diagnostic tools it enables is in development.

CDL files are generated through a process called Diagnostic Logging (DL) in which the log type, variable values and exceptions for each statement in the program are logged. Diagnostic logging is enabled by [Automated Diagnostic Log Injector][adli-url] (ADLI) tools, which automatically insert the necessary log statements to extract the diagnostic information.

The ADLI tool uses Abstract Syntax Trees (AST's) to traverse through the structure of the program to extract variable names and insert the necessary log statements for logtypes and variables. It inserts try except statements to catch any exceptions which occured when running the program and logs it. It also inserts a log statement to inject the log type map of the program into the header of the CDL file. This maps every logtype and variable to a line in the program. The enables us to only log the logtype id, effectively compressing the logtypes by default.

When diagnostic logs are ingested by CLP, having a map of the variables and log types will result in improved performance and a simpler implementation. It will be possible to further compress the logs by applying data specific compression to variables based on their variable type.

Using Diagnostic Logging, it is possible to build a fully automated log based diagnostic solution that can perform automated root cause analysis. In the next level of abstraction, it also automates the analysis, maintenance and recovery of systems. While all types of systems will benefit from diagnostic logging, distributed systems will benefit the most.

A simplified diagram of the diagnostic solution enabled by diagnostic logging is provided below.

![image](https://github.com/user-attachments/assets/429c667b-3b51-4171-becf-9bf946d0579f)

# Providing feedback

You can use GitHub issues to [report a bug][bug-report] or [request a feature][feature-req].

[bug-report]: https://github.com/vishalpalaniappan/diagnostic-log-viewer/issues
[feature-req]: https://github.com/vishalpalaniappan/diagnostic-log-viewer/issues
[yscope-previews]: https://github.com/y-scope/yscope-previews/blob/main/clp-s-s3/scripts/compress.py
[demo-url]: https://vishalpalaniappan.github.io/diagnostic-log-viewer/?filePath=https://diagnostic-logs-sample.s3.us-east-2.amazonaws.com/adli_w_error_20250610.clp.zst
[demo-url-multi-thread]: https://vishalpalaniappan.github.io/diagnostic-log-viewer/?filePath=https://diagnostic-logs-sample.s3.us-east-2.amazonaws.com/threads_w_async.clp.zst
[adli-url]: https://github.com/vishalpalaniappan/asp-adli-python
[huffman-link]: https://github.com/vancanhuit/simple-data-compression
[adli-system]: https://github.com/vishalpalaniappan/asp-adli-python/blob/main/adli_system.py
[threaded]: https://github.com/vishalpalaniappan/threads-coroutines-experiments/blob/main/threads_example/example2/example2.py
[demo-seg-url]: https://vishalpalaniappan.github.io/diagnostic-log-viewer/?filePath=https://diagnostic-logs-sample.s3.us-east-2.amazonaws.com/library_manager_demo_v1.clp.zst
[library-manager]: https://github.com/vishalpalaniappan/asp-adli-python/blob/main/sample/library_manager.py
[library-manager-sample]: https://github.com/vishalpalaniappan/asp-adli-python/tree/main/sample
# Diagnostic Log Viewer

The Diagnostic Log Viewer (DLV) is a tool which can be used to view and interact with Compressed Diagnostic Log (CDL) files. See background for more information on CDL files. The DLV can be used to step through the execution sequence of a program using the debug toolkit while investigating the call stack, variables and exceptions. It can also be used to set breakpoints and investigate specific parts of the program.

# Demo 

A demo of the current version of Semantic Execution Graph (SEG) based navigation is available [here][demo-no-failures].
* This demo was generated by injecting logs into the [Library Manager][library-manager-sample] sample program in the [ADLI][adli-url] tool.
* The sample program contains instrumented abstractions and a Semantic Design Graph (SDG) that is included in the header of the trace file.
* This trace viewer uses the SDG to create a SEG and allows the user to navigate the trace using this graph.

Demos of automated failure diagnosis and automated debugging of the failure are provided below:
* This [demo][demo-constraint-is-string] violates a constraint and accepts a book with no name (empty string), causing a failure when attempting to read the first character of the name to place it in the correct slot on the bookshelf.
* This [demo][demo-constraint-is-object] violates a constraint and doesn't initialize the bookshelf as an object, causing a failure when attempting to create a slot for a book.
* This [demo][demo-constraint-is-null] violates a constraint and initializes the bookshelf as None causing a failure when checking to see if a slot exists on the bookshelf.
* This [demo][demo-no-failures] is an execution of the library manager v1 with no failures.

A demo of the viewer for a multi threaded program is available [here][demo-url-multi-thread]. 
* The demo CDL file was generated by injecting diagnostic logs into this [program][threaded] and running it.
* In Thread3.py, this program also has async functions which can be used to inspect async call stack extraction.

A demo of the viewer for a single threaded program is available [here][demo-url].
* The demo CDL file was generated by injecting diagnostic logs into the [ADLI][adli-url] tool and then the log injected ADLI program was used to inject logs into [adli_system.py][adli-system] from the ADLI repo.
* A bug was intentionally introduced and the program was executed, generating the CDL file used in the demo.
  
# How does it work? 

> [!NOTE]  
> This section contains incomplete information. Since this was written, the instrumentation of the program has grown to include the design semantics and failure modalities specified in the Semantic Design Graph. I am leaving this here because it is still relatively accurate for stack-based navigation. An update to this section is coming soon with a more complete summary of how it works and how automated debugging is enabled.

The DLV spawns a worker to do the following: 

* Parses the header of the CDL file to extract the logtype map, variable map and the source code for each file in the program. 
* Traverses the body of the CDL file and extracts the execution sequence as well as the corresponding variables and exceptions.
* Collapses the file by extracting the stack trace for each position.
* Provides the variables, stack trace and exceptions given a position in the program. 
* Provides commands to step through the program.
* Provides the ability to set breakpoints.
* Provides the ability to enable/disable breakpoints.
* Provides the ability to play a program back from a given position (forward or backward) and to replay the program from the start.

The React application contains a CDL Provider which exposes all relevant data through contexts that can be consumed by child components. The major components in the react application are the file viewer, call stack container, variable container, breakpoint container and the debug tool kit.

## Background

Please refer to this [document][adli-docs] in the ADLI repo for background informmation.

A simplified diagram of the diagnostic solution is provided below:

![image](https://github.com/user-attachments/assets/429c667b-3b51-4171-becf-9bf946d0579f)

Note: An updated background section is in development. It will explain how by instrumenting the semantic design information into the program's abstractions (including constraints and failure modalities), we will be able to fully understand the execution of the intentional world that was designed simply by observing it. This means that we will be able to identify the difference between the design's intentions and its actual behavior, which ultimately automates debugging.

# Providing feedback

You can use GitHub issues to [report a bug][bug-report] or [request a feature][feature-req].

[bug-report]: https://github.com/vishalpalaniappan/diagnostic-log-viewer/issues
[feature-req]: https://github.com/vishalpalaniappan/diagnostic-log-viewer/issues
[yscope-previews]: https://github.com/y-scope/yscope-previews/blob/main/clp-s-s3/scripts/compress.py
[demo-url]: https://vishalpalaniappan.github.io/diagnostic-log-viewer/?filePath=https://diagnostic-logs-sample.s3.us-east-2.amazonaws.com/adli_w_error_20250610.clp.zst
[demo-url-multi-thread]: https://vishalpalaniappan.github.io/diagnostic-log-viewer/?filePath=https://diagnostic-logs-sample.s3.us-east-2.amazonaws.com/threads_w_async.clp.zst
[adli-url]: https://github.com/vishalpalaniappan/asp-adli-python
[huffman-link]: https://github.com/vancanhuit/simple-data-compression
[adli-system]: https://github.com/vishalpalaniappan/asp-adli-python/blob/main/adli_system.py
[threaded]: https://github.com/vishalpalaniappan/threads-coroutines-experiments/blob/main/threads_example/example2/example2.py
[demo-seg-url]: https://vishalpalaniappan.github.io/diagnostic-log-viewer/?filePath=https://diagnostic-logs-sample.s3.us-east-2.amazonaws.com/library_manager_demo_v1.clp.zst
[library-manager]: https://github.com/vishalpalaniappan/asp-adli-python/blob/main/sample/library_manager.py
[library-manager-sample]: https://github.com/vishalpalaniappan/asp-adli-python/tree/main/sample
[demo-fail-name-url]: https://vishalpalaniappan.github.io/diagnostic-log-viewer/?filePath=https://diagnostic-logs-sample.s3.us-east-2.amazonaws.com/library_manager_failure_empty_name.clp.zst
[demo-library-object-url]: https://vishalpalaniappan.github.io/diagnostic-log-viewer/?filePath=https://diagnostic-logs-sample.s3.us-east-2.amazonaws.com/library_manager_failure_book_shelf.clp.zst
[demo-no-failures]: https://vishalpalaniappan.github.io/diagnostic-log-viewer/?filePath=https://diagnostic-logs-sample.s3.us-east-2.amazonaws.com/demo_no_failures.clp.zst
[demo-constraint-is-string]: https://vishalpalaniappan.github.io/diagnostic-log-viewer/?filePath=https://diagnostic-logs-sample.s3.us-east-2.amazonaws.com/demo_constraint_isstring_len_1.clp.zst
[demo-constraint-is-null]: https://vishalpalaniappan.github.io/diagnostic-log-viewer/?filePath=https://diagnostic-logs-sample.s3.us-east-2.amazonaws.com/demo_constraint_isnull.clp.zst
[demo-constraint-is-object]: https://vishalpalaniappan.github.io/diagnostic-log-viewer/?filePath=https://diagnostic-logs-sample.s3.us-east-2.amazonaws.com/demo_constraint_isobject.clp.zst
[adli-docs]: https://github.com/vishalpalaniappan/asp-adli-python/blob/main/docs/overview.md